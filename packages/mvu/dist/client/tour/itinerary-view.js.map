{
  "version": 3,
  "sources": ["../../../src/client/tour/itinerary-view.ts"],
  "sourcesContent": ["import { css, html, svg, LitElement } from \"lit\";\nimport {\n  customElement,\n  state,\n  property\n} from \"lit/decorators.js\";\nimport moment from \"moment\";\nimport type {\n  Tour,\n  Destination,\n  Transportation,\n  TransportationType,\n  Segment\n} from \"../../models/Tour\";\nimport { reset, elements } from \"../shared/css-base\";\nimport \"./itinerary-item\";\n\nimport { tourContext } from \"./tour-context\";\n\n@customElement(\"itinerary-view\")\nexport class ItineraryView extends LitElement {\n  @property()\n  destinations: Array<Destination> = [];\n\n  @property()\n  transportation: Array<Transportation> = [];\n\n  @property()\n  startDate: Date = new Date();\n\n  @property()\n  selectedDate: Date | undefined;\n\n  @property()\n  handleDestinationToggle = (\n    open: boolean,\n    d: Destination\n  ) => {};\n\n  render() {\n    const destinations = this.destinations;\n    const transportation = this.transportation;\n    const startDates = destinations\n      .map((dst) => dst.nights)\n      .reduce(\n        (acc, nights, i) =>\n          acc.concat([\n            new Date(\n              acc[i].getTime() + nights * (24 * 60 * 60 * 1000)\n            )\n          ]),\n        [this.startDate]\n      );\n\n    console.log(\n      \"Rendering itinerary-view for tour\",\n      this.selectedDate,\n      destinations\n    );\n\n    const destinationView = (dst: Destination, i: number) => {\n      const startDate = startDates[i];\n      const nights = dst.nights;\n      const endDate: Date = new Date(\n        startDate.getTime() + nights * (24 * 60 * 60 * 1000)\n      );\n      const hidden =\n        this.selectedDate &&\n        (this.selectedDate.getTime() < startDate.getTime() ||\n          this.selectedDate.getTime() > endDate.getTime());\n      const open = !hidden;\n\n      return html`\n        <itinerary-item\n          item-class=\"destination\"\n          .startDate=${startDate}\n          .endDate=${endDate}\n          ?hidden=${hidden}\n          ?open=${open}\n          .handleToggle=${(open: boolean) =>\n            this.handleDestinationToggle(open, dst)}>\n          <h3 slot=\"summary\"> ${dst.name} </h3>\n          <p slot=\"summary\">\n            ${nights} night${nights === 1 ? \"\" : \"s\"}\n          </p>\n          <img class=\"featured\" src=\"${dst.featuredImage}\" />\n        </itinerary-item>\n      `;\n    };\n\n    const segmentView = (seg: Segment) => {\n      const depMoment = moment(seg.departure.time);\n      const arrMoment = moment(seg.arrival.time);\n\n      return html`\n        <h4\n          >${[seg.provider, seg.name]\n            .filter(Boolean)\n            .join(\" \")}</h4\n        >\n        <dl class=\"timings\">\n          <dt>Depart</dt>\n          <dd>${seg.departure.station}</dd>\n          <dd>\n            <time datetime=\"${depMoment.format()}\">\n              ${depMoment.format(\"h:mm A\")}\n            </time>\n          </dd>\n          <dt>Arrive</dt>\n          <dd>${seg.arrival.station}</dd>\n          <dd>\n            <time datetime=\"${arrMoment.format()}\">\n              ${arrMoment.format(\"h:mm A\")}\n            </time>\n          </dd>\n        </dl>\n      `;\n    };\n\n    const transportationView = (trn: Transportation) => {\n      const startDate = new Date(trn.startDate);\n      const endDate = trn.endDate\n        ? new Date(trn.endDate)\n        : startDate;\n      const icon = iconForTransportation(trn.type);\n\n      return html`\n        <itinerary-item\n          item-class=\"transportation\"\n          .startDate=${startDate}\n          .endDate=${endDate}>\n          <h3 slot=\"summary\">\n            <svg class=\"icon\">${icon}</svg>\n          </h3>\n          ${trn.segments.map(segmentView)}\n        </itinerary-item>\n      `;\n    };\n\n    return html`\n      <section class=\"itinerary\">\n        ${this.destinations.flatMap((d, i) =>\n          i < transportation.length\n            ? [\n                destinationView(d, i),\n                transportationView(transportation[i])\n              ]\n            : destinationView(d, i)\n        )}\n      </section>\n    `;\n  }\n\n  static styles = [\n    reset,\n    elements,\n    css`\n      .itinerary {\n        display: grid;\n        grid-area: itinerary;\n        align-self: start;\n        grid-template-columns: [start] auto [header] 4fr [info] 1fr 2fr 1fr 2fr [end];\n        gap: var(--size-spacing-large)\n          var(--size-spacing-medium);\n        align-items: baseline;\n        margin: var(--size-spacing-small);\n      }\n\n      svg.icon {\n        display: inline;\n        height: 4rem;\n        width: 4rem;\n        vertical-align: top;\n        fill: currentColor;\n      }\n\n      itinerary-item > h3 > .icon:first-child {\n        position: absolute;\n        top: 0;\n        left: 0;\n      }\n\n      itinerary-item ol,\n      itinerary-item ol > li {\n        display: contents;\n      }\n\n      itinerary-item h4 {\n        grid-column: header;\n        text-align: right;\n      }\n\n      itinerary-item[item-class=\"destination\"] h3 {\n        font-style: normal;\n        font-weight: bold;\n      }\n\n      itinerary-item img.featured {\n        width: 100%;\n        grid-column: info / end;\n        grid-row-end: span 2;\n      }\n    `\n  ];\n}\n\nfunction iconForTransportation(type: TransportationType) {\n  const hash: { [key in TransportationType]: String } = {\n    air: \"icon-airplane\",\n    rail: \"icon-train\",\n    ship: \"icon-ship\",\n    bus: \"icon-bus\"\n  };\n\n  return svg`\n    <use href=\"/icons/transportation.svg#${hash[type]}\" />\n    `;\n}\n"],
  "mappings": "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",
  "names": ["open", "moment"]
}
