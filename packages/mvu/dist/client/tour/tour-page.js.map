{
  "version": 3,
  "sources": ["../../../src/client/tour/tour-page.ts"],
  "sourcesContent": ["import { css, html, LitElement } from \"lit\";\nimport {\n  customElement,\n  property,\n  state\n} from \"lit/decorators.js\";\nimport { provide } from \"@lit/context\";\nimport { router } from \"lit-element-router\";\nimport type {\n  Tour,\n  Destination,\n  Transportation\n} from \"../../models/Tour\";\nimport { Profile } from \"../../models/Profile\";\nimport { reset, elements } from \"../shared/css-base\";\nimport tourContext from \"./tour-context\";\nimport \"../shared/blazing-header\";\nimport \"./tour-router\";\nimport \"./itinerary-view\";\nimport \"./calendar-widget\";\nimport \"./map-widget\";\n\n@router\n@customElement(\"tour-page\")\nexport class TourPage extends LitElement {\n  @state()\n  route: String = \"itinerary\";\n\n  @state()\n  params: Object = {};\n\n  @state()\n  query: Object = {};\n\n  @property({ attribute: \"tour-id\" })\n  tourId: string = \"\";\n\n  @provide({ context: tourContext })\n  @state()\n  tour: Tour = {\n    id: \"tour-skeleton\",\n    name: \"Skeleton Tour\",\n    destinations: [],\n    transportation: [],\n    startDate: new Date(),\n    endDate: new Date(),\n    entourage: []\n  } as Tour;\n\n  @state()\n  _selectedDate: Date | undefined;\n\n  @state()\n  _selectedDestination: Destination | undefined;\n\n  static routes = [\n    {\n      name: \"itinerary\",\n      pattern: \"tour/:id\"\n    },\n    {\n      name: \"destination\",\n      pattern: \"tour/:id/destination/:n\"\n    },\n    {\n      name: \"not-found\",\n      pattern: \"*\"\n    }\n  ];\n\n  router(\n    route: string,\n    params: Object,\n    query: Object,\n    data: Object = {}\n  ) {\n    this.route = route;\n    this.params = params;\n    this.query = query;\n    console.log(route, params, query, data);\n  }\n\n  connectedCallback() {\n    console.log(\"Tour ID:\", this.tourId);\n    super.connectedCallback();\n\n    fetch(`/api/tours/${this.tourId}`)\n      .then((res) => {\n        if (res.status === 200) {\n          res.json().then((json) => {\n            this.tour = json as Tour;\n          });\n        }\n      })\n      .catch((err) =>\n        console.log(\"Error when reading tour\", err)\n      );\n  }\n\n  render() {\n    const {\n      name,\n      startDate,\n      endDate,\n      destinations,\n      transportation\n    } = this.tour;\n\n    const renderMarker = (dst: Destination, i: number) => {\n      return html` <map-marker\n        lat=${dst.location.lat}\n        lon=${dst.location.lon}\n        ?selected=${dst.name ===\n        this._selectedDestination?.name}>\n        ${dst.name}\n      </map-marker>`;\n    };\n\n    return html`\n      <blazing-header title=\"${name}\"> </blazing-header>\n      <main class=\"page\">\n        <calendar-widget\n          .handleChange=${(selected: Date | undefined) =>\n            (this._selectedDate = selected)}\n          start-date=${startDate}\n          end-date=${endDate}>\n        </calendar-widget>\n        <map-widget src=\"/maps/italy.geo.json\">\n          ${destinations.map(renderMarker)}\n        </map-widget>\n        <tour-router active-route=\"${this.route}\">\n          <itinerary-view\n            route=\"itinerary\"\n            .selectedDate=${this._selectedDate}\n            .handleDestinationToggle=${(\n              open: boolean,\n              dst: Destination\n            ) =>\n              (this._selectedDestination = open\n                ? dst\n                : undefined)}>\n          </itinerary-view>\n          <p route=\"destination\">Your destination here</p>\n        </tour-router>\n        <entourage-table> </entourage-table>\n      </main>\n    `;\n  }\n\n  static styles = [\n    reset,\n    elements,\n    css`\n      main.page {\n        display: grid;\n        grid-template-columns: var(--size-width-sidebar) auto;\n        grid-template-rows: auto auto 1fr;\n        grid-template-areas:\n          \"calendar  itinerary\"\n          \"map       itinerary\"\n          \"entourage itinerary\";\n      }\n      \n      calendar-widget {\n        grid-area: calendar;\n      }\n      \n      map-widget {\n        grid-area: map;\n      }\n      \n      itinerary-view {\n        grid-area: itinerary;\n      }\n      \n      entourage-table: {\n        grid-area-entourage;\n      }\n    `\n  ];\n}\n"],
  "mappings": "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",
  "names": ["tourContext"]
}
